require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";module.exports=function(a){var b={url:a||"https://did-api-alpha.deranged.dk",user:{id:null,authKey:null}};return{asUser:function asUser(a,c){return setUser(b,a,c)},getCurrentUserId:function getCurrentUserId(){return b.user.id},user:{get:function get(a){return request(b,"GET","/user",a)}},users:{get:function get(a){return request(b,"GET","/users",a)},create:function create(a,c){return request(b,"POST","/users",a,c)}},circles:{create:function create(a,c){return request(b,"POST","/circles",a,c)},update:function update(a,c,d){return request(b,"PUT","/circles/"+a,c,d)},get:function get(a,c){return request(b,"GET","/circles/"+a,c)},getAll:function getAll(a){return request(b,"GET","/circles",a)}}}};function setUser(a,b,c){a.user.id=b,a.user.authKey=c}function request(a,b,c,d,e){e||(e=d,d=void 0);var f=new XMLHttpRequest;return f.open(b,a.url+c),f.setRequestHeader("Authorization","Basic "+btoa(a.user.id+":"+a.user.authKey)),f.onreadystatechange=function(){if(4==f.readyState){if(200<=f.status&&300>f.status){if("json"!=f.responseType){var a=null;try{a=JSON.parse(f.response)}catch(a){return e({trace:new Error("API responded in something that was not JSON and could not be parsed as JSON."),status:f.statusText,responseType:f.responseType,response:f.response})}return e(null,a)}return e(null,f.response)}e({trace:new Error("API call failed."),status:f.statusText,responseType:f.responseType,response:f.response})}},d?(f.setRequestHeader("Content-Type","application/json"),f.send(JSON.stringify(d))):void f.send()}

},{}],2:[function(require,module,exports){
"use strict";module.exports=function(a,b){return function(c){return{renderIn:function renderIn(d){d.innerHTML="<form class=\"did-form did-circle-form\">\r\n    <div class=\"did-form-row\">\r\n        <label for=\"title\">\r\n            Title\r\n            <input type=\"text\" name=\"title\">\r\n        </label>\r\n        <label for=\"vision\">\r\n            Vision\r\n            <textarea name=\"vision\" class=\"did-markdown-field\"></textarea>\r\n        </label>\r\n        <label for=\"mission\">\r\n            Mission\r\n            <textarea name=\"mission\" class=\"did-markdown-field\"></textarea>\r\n        </label>\r\n        <label for=\"aim\">\r\n            Aim\r\n            <textarea name=\"aim\" class=\"did-markdown-field\"></textarea>\r\n        </label>\r\n    </div>\r\n    <div class=\"did-form-row\">\r\n        <label for=\"fullState\">\r\n            Open to more members?\r\n            <select name=\"fullState\">\r\n                <option value=\"lookingForMore\">Looking for more</option>\r\n                <option value=\"openForMore\">Open for more</option>\r\n                <option value=\"full\">Full</option>\r\n            </select>\r\n        </label>\r\n        <label for=\"expectationsForMembers\">\r\n            Expectations for members\r\n            <textarea name=\"expectationsForMembers\" class=\"did-markdown-field\"></textarea>\r\n        </label>\r\n        <label for=\"inviteMembers\">\r\n            Invite members to circle?\r\n            <select name=\"inviteMembers\">\r\n                <option>Loading members...</option>\r\n            </select>\r\n        </label>\r\n        <div class=\"did-invited-members-list\"></div>\r\n        <!--//TODO: we also need a way to add members, enter expectations for members.-->\r\n    </div>\r\n    <button>Create circle</button>\r\n    <div class=\"did-form-overlay\">\r\n        <div class=\"did-overlay-message did-overlay-message-loading\">Creating circle...</div>\r\n        <div class=\"did-overlay-message did-overlay-message-failure\">Failed to create circle.</div>\r\n        <div class=\"did-overlay-message did-overlay-message-success\">Circle created!</div>\r\n    </div>\r\n</form>\r\n";var f=d.querySelector("form.did-circle-form");c&&c.fill&&prefillFields(f,c.fill);var g=f.querySelector("[name=inviteMembers]"),h=f.querySelector(".did-invited-members-list"),i=[];a.users.get(function(b,c){if(b)return console.error("Failed to load users.",b);var d=c.users.filter(function(b){return b.userId!=a.getCurrentUserId()}).sort(function(c,a){return c.name==a.name?0:c.name<a.name?-1:1}).map(function(a){return"<option value=\""+a.userId+"\">"+a.name+"</option>"});g.innerHTML="<option></option>"+d,g.addEventListener("change",function(){var a=g.value,b=g.querySelector("option[value='"+a+"']"),c=b.innerText;g.removeChild(b);var d={id:a,name:c};i.push(a);var f=createDomNode("div",{class:"did-invite-member",text:c}),e=createDomNode("div",{class:"did-uninvite-member-button"});f.appendChild(e),h.appendChild(f),e.addEventListener("click",function(a){a.preventDefault(),h.removeChild(f),i=i.filter(function(a){return a!=d.id});var b=createDomNode("option",{value:d.id,text:d.name}),c=getElementAlphaAfter(g,d.name);return g.insertBefore(b,c),!1})})}),f.addEventListener("submit",function(c){return c.preventDefault(),sendCreateCircleRequest(a,b,f,i),!1})}}}};function prefillFields(a,b){Object.keys(b).forEach(function(c){var d=a.querySelector("[name="+c+"]");return d?void(d.value=b[c]):console.warn("[did/create-circle-include] Tried to prefill",c,"with value",b[c],"but no such input element exists in the form.")})}function createDomNode(a,b){var c=document.createElement(a);return b.class&&(c.classList=b.class),b.value&&(c.value=b.value),b.text?c.innerText=b.text:b.html&&(c.innerHTML=b.html),c}function getElementAlphaAfter(a,b){return Array.prototype.filter.call(a.children,function(a){return a.innerText>=b})[0]}function sendCreateCircleRequest(a,b,c,d){var e=validateData(c,d);if(!e.valid)return console.error("Failed to submit form because invalid data.");var f=getOverlay(c);f.loading(),a.circles.create(e.data,function(a,c){return a?(f.failure(),console.error("Failed to create circle.",a)):void f.success(function(){return b.circles.view(c.circle.id)})})}function getOverlay(a){var b=a.querySelector(".did-form-overlay"),c=b.querySelector(".did-overlay-message-loading"),d=b.querySelector(".did-overlay-message-failure"),e=b.querySelector(".did-overlay-message-success"),f=function(){c.style="",d.style="",e.style=""},g=function(){b.style="display:flex;opacity:0;",f(),setTimeout(function(){return b.style=""},500)},h=function(a){f(),b.style="display:flex;opacity:1;",a.style="opacity:1;"};return{loading:function loading(){return h(c)},failure:function failure(){h(d),setTimeout(g,2500)},success:function success(a){h(e),setTimeout(function(){g(),a()},800)}}}function validateData(a,b){var c=function(b){return a[b].value},d=c("title"),e=c("vision"),f=c("mission"),g=c("aim"),h=c("fullState"),i=c("expectationsForMembers");return{valid:!0,data:{name:d,vision:e,mission:f,aim:g,fullState:h,expectationsForMembers:i,invited:b}}}

},{}],3:[function(require,module,exports){
"use strict";module.exports=function(a,b){return{circleCreate:require("./circles/create")(a,b)}};

},{"./circles/create":2}],4:[function(require,module,exports){
"use strict";module.exports=function(a){return a?validateConf(a):{circles:{view:function view(a){return location.pathname="/circles/"+a}}}};function validateConf(a){return a}

},{}],"did":[function(require,module,exports){
"use strict";module.exports=function(a,b){var c=require("./api-client/client")(a),d=require("./integration/integration")(b);return{api:c,includes:require("./includes/index")(c,d)}};

},{"./api-client/client":1,"./includes/index":3,"./integration/integration":4}]},{},[]);
